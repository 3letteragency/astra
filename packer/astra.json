{
  "variables": {
    "vultr_api_key": "{{ env `VULTR_API_KEY` }}",
    "s3_access_key": "{{ env `S3_ACCESS_KEY` }}",
    "s3_secret_key": "{{ env `S3_SECRET_KEY` }}",
    "game_archive_url": "{{ env `GAME_ARCHIVE_URL` }}",
    "principia_zip_url": "{{ env `PRINCIPIA_ZIP_URL` }}"
  },
  "builders": [
    {
      "type": "vultr",
      "api_key": "{{ user `vultr_api_key` }}",
      "os_id": 387,
      "region_id": 22,
      "plan_id": 201,
      "snapshot_description": "astra-node",
      "ssh_username": "root",
      "ssh_key_ids": [
        "{{ user `vultr_ssh_key_id_mission_control` }}"
      ],
      "state_timeout": "60m",
      "instance_label": "astra-node",
      "hostname": "astra-node"
    }
  ],
  "provisioners": [
    {
      "type": "shell",
      "inline": [
        "apt -y update",
        "apt -y install ansible"
      ]
    },
    {
      "type": "ansible-local",
      "playbook_file": "files/ansible/astra.yml",
      "extra_arguments": ["--extra-vars", "\"s3_access_key={{ user `s3_access_key` }}\"", "\"s3_secret_key={{ user `s3_secret_key` }}\""]
    }
  ]
}
